console.log("OCR Extension background script loaded"),browser.browserAction.onClicked.addListener(async e=>{console.log("Extension icon clicked for tab",e.id),browser.tabs.sendMessage(e.id,{action:"startSelection"})}),browser.runtime.onMessage.addListener(async(e,o)=>{if(e&&"captureViewport"===e.action)try{return{dataUrl:await browser.tabs.captureVisibleTab(o.tab.windowId,{format:"png"})}}catch(e){throw console.error("captureVisibleTab failed:",e),e}});